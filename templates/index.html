<!DOCTYPE html>
<html>
<head>
    <title>Welches Bundesland?</title>
    <style>
        body {
            background-color: #1E3A8A; /* Blau */
            color: white;
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
        }

        #question {
            font-size: 80px;
            margin: 0;
        }

        #subtitle {
            font-size: 28px;
            margin-bottom: 50px;
        }

        #detective {
            display: none;
            margin: 20px auto;
            width: 150px;
            animation: shake 1s infinite;
        }

        @keyframes shake {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(5deg); }
            50% { transform: rotate(-5deg); }
            75% { transform: rotate(5deg); }
            100% { transform: rotate(0deg); }
        }

        #result, #coords, #accuracy {
            font-size: 24px;
            margin-top: 20px;
        }

        #flag {
            margin-top: 20px;
        }

        #info {
            margin-top: 20px;
            font-size: 20px;
        }

        button {
            padding: 15px 30px;
            font-size: 22px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            background-color: #2563EB;
            color: white;
        }

        button:hover {
            background-color: #1D4ED8;
        }
    </style>
</head>
<body>

    <div id="question">‚ùì</div>
    <div id="subtitle">Welches Bundesland bist du?</div>
    <button onclick="getLocation()">Lass mich suchen üîç</button>

    <img id="detective" src="/static/detective.png" alt="Detektiv" />

    <div id="result"></div>
    <div id="coords"></div>
    <div id="accuracy"></div>
    <div id="flag"></div>
    <div id="info"></div>

<script>
function getLocation() {
    if (navigator.geolocation) {
        // Detektiv anzeigen
        document.getElementById("detective").style.display = "block";
        document.getElementById("result").innerText = "Suche...";
        document.getElementById("coords").innerText = "";
        document.getElementById("accuracy").innerText = "";

        navigator.geolocation.getCurrentPosition(sendPosition, showError, { enableHighAccuracy: true });
    } else {
        alert("Geolocation wird nicht unterst√ºtzt.");
    }
}

function sendPosition(position) {
    const lat = position.coords.latitude;
    const lon = position.coords.longitude;
    const accuracy = position.coords.accuracy;

    // Koordinaten direkt auf der Seite anzeigen
    document.getElementById("coords").innerText = "Latitude: " + lat + ", Longitude: " + lon;
    document.getElementById("accuracy").innerText = "Genauigkeit: " + accuracy + " Meter";

    fetch("/location", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            lat: lat,
            lon: lon,
            accuracy: accuracy
        })
    })
    .then(response => response.json())
    .then(data => {
        // Detektiv verstecken
        document.getElementById("detective").style.display = "none";

        let state = data.state;
        document.getElementById("result").innerText = "Bundesland: " + state;

        // Flagge
        let stateFile = state.toLowerCase().replace("√§","ae").replace("√∂","oe").replace("√º","ue").replace("√ü","ss").replace(/ /g,"_");
        document.getElementById("flag").innerHTML = `<img src="/static/${stateFile}.png" alt="${state} Flagge" width="200">`;

        // Besonderheiten
        const specialInfo = {
            "Nordrhein-Westfalen": "NRW: Land der Industrie, Karneval und Rheinmetropolen.",
            "Hessen": "Hessen: Bankenstadt Frankfurt und gr√ºner Taunus.",
            "Bayern": "Bayern: Berge, Bier und Tradition.",
            // weitere Bundesl√§nder hinzuf√ºgen
        };

        document.getElementById("info").innerText = specialInfo[state] || "Interessantes Bundesland!";
    });
}

function showError(error) {
    document.getElementById("detective").style.display = "none";
    switch(error.code) {
        case error.PERMISSION_DENIED:
            alert("Standortzugriff verweigert.");
            break;
        case error.POSITION_UNAVAILABLE:
            alert("Standort nicht verf√ºgbar.");
            break;
        case error.TIMEOUT:
            alert("Zeit√ºberschreitung beim Abrufen des Standorts.");
            break;
        default:
            alert("Unbekannter Fehler.");
            break;
    }
}
</script>

</body>
</html>
